/**
 * skylark-langx-debugs - The skylark debug utility library
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["./debugs"],function(n){function t(n){var e=(n=n||{guess:!0}).e||null,r=!!n.guess,o=new t.implementation,i=o.run(e);return r?o.guessAnonymousFunctions(i):i}return t.implementation=function(){},t.implementation.prototype={run:function(n,t){return n=n||this.createException(),"other"===(t=t||this.mode(n))?this.other(arguments.callee):this[t](n)},createException:function(){try{this.undef()}catch(n){return n}},mode:function(n){return n.arguments&&n.stack?"chrome":"string"==typeof n.message&&"undefined"!=typeof window&&window.opera?n.stacktrace?n.message.indexOf("\n")>-1&&n.message.split("\n").length>n.stacktrace.split("\n").length?"opera9":n.stack?n.stacktrace.indexOf("called from line")<0?"opera10b":"opera11":"opera10a":"opera9":n.stack?"firefox":"other"},instrumentFunction:function(n,e,r){var o=(n=n||window)[e];n[e]=function(){return r.call(this,t().slice(4)),n[e]._instrumented.apply(this,arguments)},n[e]._instrumented=o},deinstrumentFunction:function(n,t){n[t].constructor===Function&&n[t]._instrumented&&n[t]._instrumented.constructor===Function&&(n[t]=n[t]._instrumented)},chrome:function(n){var t=(n.stack+"\n").replace(/^\S[^\(]+?[\n$]/gm,"").replace(/^\s+(at eval )?at\s+/gm,"").replace(/^([^\(]+?)([\n$])/gm,"{anonymous}()@$1$2").replace(/^Object.<anonymous>\s*\(([^\)]+)\)/gm,"{anonymous}()@$1").split("\n");return t.pop(),t},firefox:function(n){return n.stack.replace(/(?:\n@:0)?\s+$/m,"").replace(/^\(/gm,"{anonymous}(").split("\n")},opera11:function(n){for(var t=/^.*line (\d+), column (\d+)(?: in (.+))? in (\S+):$/,e=n.stacktrace.split("\n"),r=[],o=0,i=e.length;o<i;o+=2){var c=t.exec(e[o]);if(c){var s=c[4]+":"+c[1]+":"+c[2],u=c[3]||"global code";u=u.replace(/<anonymous function: (\S+)>/,"$1").replace(/<anonymous function>/,"{anonymous}"),r.push(u+"@"+s+" -- "+e[o+1].replace(/^\s+/,""))}}return r},opera10b:function(n){for(var t=/^(.*)@(.+):(\d+)$/,e=n.stacktrace.split("\n"),r=[],o=0,i=e.length;o<i;o++){var c=t.exec(e[o]);if(c){var s=c[1]?c[1]+"()":"global code";r.push(s+"@"+c[2]+":"+c[3])}}return r},opera10a:function(n){for(var t=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,e=n.stacktrace.split("\n"),r=[],o=0,i=e.length;o<i;o+=2){var c=t.exec(e[o]);if(c){var s=c[3]||"{anonymous}";r.push(s+"()@"+c[2]+":"+c[1]+" -- "+e[o+1].replace(/^\s+/,""))}}return r},opera9:function(n){for(var t=/Line (\d+).*script (?:in )?(\S+)/i,e=n.message.split("\n"),r=[],o=2,i=e.length;o<i;o+=2){var c=t.exec(e[o]);c&&r.push("{anonymous}()@"+c[2]+":"+c[1]+" -- "+e[o+1].replace(/^\s+/,""))}return r},other:function(n){for(var t,e,r=/function\s*([\w\-$]+)?\s*\(/i,o=[];n&&n.arguments&&o.length<10;)t=r.test(n.toString())&&RegExp.$1||"{anonymous}",e=Array.prototype.slice.call(n.arguments||[]),o[o.length]=t+"("+this.stringifyArguments(e)+")",n=n.caller;return o},stringifyArguments:function(n){for(var t=[],e=Array.prototype.slice,r=0;r<n.length;++r){var o=n[r];void 0===o?t[r]="undefined":null===o?t[r]="null":o.constructor&&(o.constructor===Array?o.length<3?t[r]="["+this.stringifyArguments(o)+"]":t[r]="["+this.stringifyArguments(e.call(o,0,1))+"..."+this.stringifyArguments(e.call(o,-1))+"]":o.constructor===Object?t[r]="#object":o.constructor===Function?t[r]="#function":o.constructor===String?t[r]='"'+o+'"':o.constructor===Number&&(t[r]=o))}return t.join(",")},sourceCache:{},ajax:function(n){var t=this.createXMLHTTPObject();if(t)try{return t.open("GET",n,!1),t.send(null),t.responseText}catch(n){}return""},createXMLHTTPObject:function(){for(var n,t=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],e=0;e<t.length;e++)try{return n=t[e](),this.createXMLHTTPObject=t[e],n}catch(n){}},isSameDomain:function(n){return-1!==n.indexOf(location.hostname)},getSource:function(n){return n in this.sourceCache||(this.sourceCache[n]=this.ajax(n).split("\n")),this.sourceCache[n]},guessAnonymousFunctions:function(n){for(var t=0;t<n.length;++t){var e=n[t],r=/\{anonymous\}\(.*\)@(.*)/.exec(e);if(r){var o=/^(.*?)(?::(\d+))(?::(\d+))?(?: -- .+)?$/.exec(r[1]);if(o){var i=o[1],c=o[2],s=o[3]||0;if(i&&this.isSameDomain(i)&&c){var u=this.guessAnonymousFunction(i,c,s);n[t]=e.replace("{anonymous}",u)}}}}return n},guessAnonymousFunction:function(n,t,e){var r;try{r=this.findFunctionName(this.getSource(n),t)}catch(t){r="getSource failed with url: "+n+", exception: "+t.toString()}return r},findFunctionName:function(n,t){for(var e,r,o,i=/function\s+([^(]*?)\s*\(([^)]*)\)/,c=/['"]?([0-9A-Za-z_]+)['"]?\s*[:=]\s*function\b/,s=/['"]?([0-9A-Za-z_]+)['"]?\s*[:=]\s*(?:eval|new Function)\b/,u="",a=Math.min(t,20),f=0;f<a;++f)if((o=(e=n[t-f-1]).indexOf("//"))>=0&&(e=e.substr(0,o)),e){if(u=e+u,(r=c.exec(u))&&r[1])return r[1];if((r=i.exec(u))&&r[1])return r[1];if((r=s.exec(u))&&r[1])return r[1]}return"(?)"}},n.StackTrace=t});
//# sourceMappingURL=sourcemaps/stack-trace.js.map
